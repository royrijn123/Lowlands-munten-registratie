<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Lowlands Scan</title>
</head>
<body>
<script>
  const apiUrl = "https://script.google.com/macros/s/AKfycbzYYy8v9JwosKehMYOAH6nZumg9l1x2QnC1mdwGlkFBmPnUbYU_Qt5WctGjeriXYtStAA/exec";

  let chipOwner = localStorage.getItem("chipOwner");
  if (!chipOwner) {
    chipOwner = prompt("Wiens chip scande je?");
    if (chipOwner) {
      localStorage.setItem("chipOwner", chipOwner);
    } else {
      alert("Naam chiphouder is verplicht!");
      throw new Error("Geen chiphoudernaam ingevuld");
    }
  }

  let scannerName = localStorage.getItem("scannerName");
  if (!scannerName) {
    scannerName = prompt(`Je scande de chip van ${chipOwner}. Wat is jouw naam?`);
    if (scannerName) {
      localStorage.setItem("scannerName", scannerName);
    } else {
      alert("Naam scanner is verplicht!");
      throw new Error("Geen scannernaam ingevuld");
    }
  }

  const data = new URLSearchParams();
  data.append("chipOwner", chipOwner);
  data.append("scanner", scannerName);

  fetch(apiUrl, {
    method: "POST",
    body: data
  })
  .then(res => res.text())
  .then(text => {
    alert(`Scan geregistreerd: ${text}`);
  })
  .catch(err => {
    console.error(err);
    alert("Fout bij registreren scan!");
  });
</script>
</body>
</html>
